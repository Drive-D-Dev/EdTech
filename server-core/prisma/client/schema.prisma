generator client {
  provider = "prisma-client-js"
  output   = "./client"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model User {
  id       Int    @id @default(autoincrement())
  email    String @unique
  password String
  name     String
  role     Role
}

enum Role {
  ADMIN
  USER
}

model Choice {
  id          Int      @id @default(autoincrement())
  content     String   @db.Text
  number      Int
  question_id Int
  Question    Question @relation(fields: [question_id], references: [id], onUpdate: Restrict)
  Answer      Answer[]

  @@index([question_id], map: "Choice_Question_id_fk")
}

model Question {
  id                       Int                        @id @default(autoincrement())
  content                  String                     @db.Text
  explanation              String                     @db.Text
  accuracy_percentage      Decimal                    @db.Decimal(5, 2)
  Choice                   Choice[]
  Study_Set_Questions_List Study_Set_Questions_List[]
  Answer                   Answer[]
}

model Answer {
  question_id Int      @unique
  choice_id   Int
  Question    Question @relation(fields: [question_id], references: [id], onUpdate: Restrict)
  Choice      Choice   @relation(fields: [choice_id], references: [id], onUpdate: Restrict)

  @@index([question_id], map: "Answer_Question_id_fk")
  @@index([choice_id], map: "Answer_Choice_id_fk")
}

model Study_Set {
  id                       Int                        @id @default(autoincrement())
  stage                    String                     @db.VarChar(20)
  label                    String                     @db.VarChar(255)
  Study_Set_Questions_List Study_Set_Questions_List[]
}

model Study_Set_Questions_List {
  id          Int        @id @default(autoincrement())
  question_id Int
  studyset_id Int?
  Question    Question   @relation(fields: [question_id], references: [id], onUpdate: Restrict)
  Study_Set   Study_Set? @relation(fields: [studyset_id], references: [id], onDelete: Restrict, onUpdate: Restrict)

  @@index([question_id], map: "Study_Set_Questions_List_Question_id_fk")
  @@index([studyset_id], map: "Study_Set_Questions_List_Study_Set_id_fk")
}
